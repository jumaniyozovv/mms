generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum UserRole {
  ADMIN
  MANAGER
  USER
}

enum DeviceType {
  DESKTOP
  MOBILE
  TABLET
  UNKNOWN
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  firstName String   @map("first_name")
  lastName  String   @map("last_name")
  role      UserRole @default(USER)
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  deviceSessions DeviceSession[]

  @@map("users")
}

model DeviceSession {
  id             String     @id @default(cuid())
  userId         String     @map("user_id")
  socketId       String     @unique @map("socket_id")
  browserName    String?    @map("browser_name")
  browserVersion String?    @map("browser_version")
  osName         String?    @map("os_name")
  osVersion      String?    @map("os_version")
  deviceType     DeviceType @default(UNKNOWN) @map("device_type")
  networkType    String?    @map("network_type")
  ipAddress      String?    @map("ip_address")
  connectedAt    DateTime   @default(now()) @map("connected_at")
  disconnectedAt DateTime?  @map("disconnected_at")

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("device_sessions")
}
